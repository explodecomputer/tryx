<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR-TRYX (treasure your exceptions) • tryx</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="MR-TRYX (treasure your exceptions)">
<meta property="og:description" content="Heterogeneity in MR analyses can arise due to horizontal pleiotropy. This package uses MR-Base to identify possible traits that can explain the heterogeneity, with a view to identifying novel putative associations, and adjusting for their influences to reduce heterogeneity and improve power.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tryx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/guide.html">Test file for MR-TRYX</a>
    </li>
    <li>
      <a href="articles/test_mrtryx.html">Test file for MR-TRYX</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="treasure-your-exceptions-tryx" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#treasure-your-exceptions-tryx" class="anchor"></a>Treasure your exceptions! (TRYX)</h1></div>
<p>This package will perform MR-TRYX analysis, which entails the following.</p>
<p>In MR analysis a major assumption is that the SNP influences the outcome only through the exposure. If the SNP influences the outcome through some other (candidate) traits, in addition to influencing through the exposure, then the MR estimate can be biased.</p>
<p>Knowing which traits through which SNPs might be acting in a horizontal pleiotropic manner allows us to exploit these outliers to:</p>
<ol>
<li>Identify novel candidate traits that influence the outcome (and possibly the exposure also)</li>
<li>Adjust the SNP-outcome / SNP-exposure ratio based on knowledge of the alternative pathways, thereby reducing heterogeneity in the original exposure-outcome effect estimate.</li>
</ol>
<p>This package uses the MR-Base infrastructure to search for alternative pathways through which instruments might influence the exposure.</p>
<hr>
<p>The package name TRYX (pronounced ‘tricks’) is taken from the phrase ‘TReasure Your Exceptions’, a quote from William Bateson (1908).</p>
<hr>
<div id="requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h2>
<p>This software is an R package that depends on various other packages available on CRAN (see DESCRIPTION file). It has only been tested on some R versions &gt;= 3.2.0. The software will run on any standard laptop, desktop or server for which R can be installed.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>A beta development version can bbe installed directly from this repository.</p>
<p>First install the <code>TwoSampleMR</code> and <code>RadialMR</code> R packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"MRCIEU/TwoSampleMR"</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"WSpiller/RadialMR"</span>)</a></code></pre></div>
<p>Next install the <code>tryx</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"explodecomputer/tryx"</span>)</a></code></pre></div>
<p>You may also want to install some plotting packages</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ggplot2"</span>, <span class="st">"ggrepel"</span>, <span class="st">"igraph"</span>))</a></code></pre></div>
<p>and a package for simulating genotype-phenotype maps</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"explodecomputer/simulateGP"</span>)</a></code></pre></div>
<p>It should not take more than a few minutes to install all of these packages.</p>
<hr>
</div>
<div id="guide" class="section level2">
<h2 class="hasAnchor">
<a href="#guide" class="anchor"></a>Guide</h2>
<div id="basic-analysis-implemented-in-r6" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-analysis-implemented-in-r6" class="anchor"></a>Basic analysis (Implemented in R6)</h3>
<p>The following analyses should run within 10 minutes, depending on internet speed and the traffic that the MR-Base servers are experiencing.</p>
<p>Begin by choosing an exposure-outcome hypothesis to explore. e.g. LDL cholesterol on coronary heart disease. These data can be extracted from MR-Base:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">install_github</span>(<span class="st">"mrcieu/TwoSampleMR@ieugwasr"</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tryx)</a>
<a class="sourceLine" id="cb5-4" title="4">a &lt;-<span class="st"> </span><span class="kw">extract_instruments</span>(<span class="st">"ieu-a-300"</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">b &lt;-<span class="st"> </span><span class="kw">extract_outcome_data</span>(a<span class="op">$</span>SNP, <span class="st">"ieu-a-7"</span>, <span class="dt">access_token=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb5-6" title="6">dat &lt;-<span class="st"> </span><span class="kw">harmonise_data</span>(a,b)</a></code></pre></div>
<p>We can now perform the analysis:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">x &lt;-<span class="st"> </span>Tryx<span class="op">$</span><span class="kw">new</span>(dat)</a>
<a class="sourceLine" id="cb6-2" title="2">x<span class="op">$</span><span class="kw">mrtryx</span>()</a></code></pre></div>
<p>This will do the following:</p>
<ol>
<li>Find outlier SNPs in the exposure-outcome analysis</li>
<li>Find traits in the MR-Base database that those outliers associate with. These traits are known as ‘candidate traits’</li>
<li>Extract instruments for those ‘candidate traits’</li>
<li>Perform MR of each of those ‘candidate traits’ against the exposure and the outcome</li>
</ol>
<p>The analysis can be done one by one running the following commands:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">#Find outlier SNPs in the exposure-outcome analysis</span></a>
<a class="sourceLine" id="cb7-2" title="2">x<span class="op">$</span><span class="kw">get_outliers</span>()</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#Find traits in the MR-Base database that those outliers associate with. These traits are known as 'candidate traits'</span></a>
<a class="sourceLine" id="cb7-5" title="5">x<span class="op">$</span><span class="kw">set_candidate_traits</span>()</a>
<a class="sourceLine" id="cb7-6" title="6">x<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>()</a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#Extract instruments for those 'candidate traits'</span></a>
<a class="sourceLine" id="cb7-9" title="9">x<span class="op">$</span><span class="kw">extractions</span>() <span class="co">#which includes the following functions:</span></a>
<a class="sourceLine" id="cb7-10" title="10">  x<span class="op">$</span><span class="kw">candidate_instruments</span>()</a>
<a class="sourceLine" id="cb7-11" title="11">  x<span class="op">$</span><span class="kw">outcome_instruments</span>()</a>
<a class="sourceLine" id="cb7-12" title="12">  x<span class="op">$</span><span class="kw">exposure_instruments</span>()</a>
<a class="sourceLine" id="cb7-13" title="13">  x<span class="op">$</span><span class="kw">exposure_candidate_instruments</span>()</a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#Make datasets for MR analysis</span></a>
<a class="sourceLine" id="cb7-16" title="16">x<span class="op">$</span><span class="kw">harmonise</span>() <span class="co">#which includes the following functions:</span></a>
<a class="sourceLine" id="cb7-17" title="17">  x<span class="op">$</span><span class="kw">candidate_outcome_dat</span>()</a>
<a class="sourceLine" id="cb7-18" title="18">  x<span class="op">$</span><span class="kw">candidate_exposure_dat</span>()</a>
<a class="sourceLine" id="cb7-19" title="19">  x<span class="op">$</span><span class="kw">exposure_candidate_dat</span>()</a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#Perform MR of each of those 'candidate traits' against the exposure and the outcomes</span></a>
<a class="sourceLine" id="cb7-22" title="22">x<span class="op">$</span><span class="kw">mr</span>()</a></code></pre></div>
<p>See the ?tryx.scan for options on the parameters for this analysis. e.g. You can specify your own set of outliers, for example SNPs that have extreme p-values in the outcome GWAS</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">a &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(dat, pval.outcome <span class="op">&lt;</span><span class="st"> </span><span class="fl">5e-8</span>)<span class="op">$</span>SNP)</a>
<a class="sourceLine" id="cb8-2" title="2">x &lt;-<span class="st"> </span>Tryx<span class="op">$</span><span class="kw">new</span>(dat)</a>
<a class="sourceLine" id="cb8-3" title="3">x<span class="op">$</span><span class="kw">mrtryx</span>(<span class="dt">outliers=</span>a)</a></code></pre></div>
<p>The next steps are to determine which of the candidate traits are of interest (e.g. using p-value thresholds), visualise the results, and adjust the exposure-outcome estimates based on knowledge of the ‘candidate trait’ associations.</p>
</div>
<div id="significant-candidate-traits" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-candidate-traits" class="anchor"></a>Significant candidate traits</h3>
<p>One can determine which of the putative associations might be ‘interesting’ in different ways. We have provided a simple convenience function to apply different multiple testing corrections. e.g.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">x<span class="op">$</span><span class="kw">tryx.sig</span>()</a></code></pre></div>
<p>Will by default use FDR of 5%. See <code>?tryx.sig</code> for more options.</p>
</div>
<div id="adjustment" class="section level3">
<h3 class="hasAnchor">
<a href="#adjustment" class="anchor"></a>Adjustment</h3>
<p>Finally, to adjust the SNP effects on the exposure and outcome traits given their influences on the candidate traits, we can run:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">x<span class="op">$</span><span class="kw">adjustment</span>()</a>
<a class="sourceLine" id="cb10-2" title="2">x<span class="op">$</span><span class="kw">adjustment.mv</span>()</a>
<a class="sourceLine" id="cb10-3" title="3">x<span class="op">$</span><span class="kw">analyse</span>()</a>
<a class="sourceLine" id="cb10-4" title="4">x<span class="op">$</span><span class="kw">analyse.mv</span>()</a></code></pre></div>
<p>By default, this adjusts for the trait that has the largest impact for a particular SNP.</p>
<p>The <code>x$output$adjustment$estimates</code> show the adjusted effect estimates. A plot is generated showing how SNP effects have changed due to candidate trait adjustments in <code>x$output$adjustment$plot</code>.</p>
</div>
<div id="visualisation" class="section level3">
<h3 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h3>
<p>To produce a basic diagram of the connectivity of SNPs, candidate traits, exposure and outcome:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="reference/tryx.network.html">tryx.network</a></span>(tryxscan)</a></code></pre></div>
<p>This shows that some candidate traits influence the exposure only, the outcome only, or both the exposure and the outcome.</p>
<p>You can also create a volcano plot of the candidate-exposure and/or candidate-outcome associations. e.g. to show exposures and outcomes</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="reference/volcano_plot.html">volcano_plot</a></span>(</a>
<a class="sourceLine" id="cb12-2" title="2">    <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(tryxscan<span class="op">$</span>candidate_exposure_mr, tryxscan<span class="op">$</span>candidate_outcome_mr)</a>
<a class="sourceLine" id="cb12-3" title="3">)</a></code></pre></div>
<p>or e.g. just exposures</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="reference/volcano_plot.html">volcano_plot</a></span>(tryxscan<span class="op">$</span>candidate_exposure_mr)</a></code></pre></div>
<hr>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Gibran Hemani <br><small class="roles"> Author, maintainer </small>  </li>
<li>Yoonsu Cho <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Gibran Hemani, Yoonsu Cho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
